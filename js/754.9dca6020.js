"use strict";(globalThis["webpackChunkdbdiagram_oss"]=globalThis["webpackChunkdbdiagram_oss"]||[]).push([[754],{2754:(e,l,t)=>{t.r(l),t.d(l,{default:()=>ll});var o=t(9835),a=t(6970),n=t(1957),i=t(499),s=t(5424),r=t(9302);function c(e,l,t,n,i,s){const r=(0,o.up)("q-tab"),c=(0,o.up)("q-tabs"),d=(0,o.up)("q-toolbar"),m=(0,o.up)("q-tab-panel"),u=(0,o.up)("q-tab-panels"),p=(0,o.up)("q-space"),g=(0,o.up)("q-btn"),f=(0,o.up)("dialog-layout"),_=(0,o.up)("q-card"),b=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(b,{ref:"dialogRef",onHide:n.onDialogHide,seamless:"theme"===n.tab},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{class:"q-dialog-plugin ace-preferences-dialog"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,null,{header:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,{modelValue:n.tab,"onUpdate:modelValue":l[0]||(l[0]=e=>n.tab=e)},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.tabs,(e=>((0,o.wg)(),(0,o.j4)(r,{name:e.name},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e.label),1)])),_:2},1032,["name"])))),256))])),_:1},8,["modelValue"])])),_:1})])),footer:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o.Wm)(p),(0,o.Wm)(g,{flat:"",color:"primary",label:"OK",onClick:n.onOKClick},null,8,["onClick"]),(0,o.Wm)(g,{flat:"",color:"primary",label:"Cancel",onClick:n.onCancelClick},null,8,["onClick"])])),_:1})])),default:(0,o.w5)((()=>[(0,o.Wm)(u,{modelValue:n.tab,"onUpdate:modelValue":l[1]||(l[1]=e=>n.tab=e)},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.tabs,(e=>((0,o.wg)(),(0,o.j4)(m,{name:e.name},{default:(0,o.w5)((()=>[((0,o.wg)(),(0,o.j4)((0,o.LL)(e.component)))])),_:2},1032,["name"])))),256))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["onHide","seamless"])}var d=t(906),m=t(9684),u=t.n(m);const p=e=>((0,o.dD)("data-v-e5e3a5d6"),e=e(),(0,o.Cn)(),e),g=p((()=>(0,o._)("div",{class:"ace_gutter","aria-hidden":"true",style:{left:"0px",width:"2rem"}},[(0,o._)("div",{class:"ace_layer ace_gutter-layer ace_folding-enabled",style:{height:"1e+06px",top:"0px",left:"0px",width:"2rem"}},[(0,o._)("div",{class:"ace_gutter-cell",style:{height:"1rem",top:"0rem"}},[(0,o.Uk)("1"),(0,o._)("span",{style:{display:"none"}})]),(0,o._)("div",{class:"ace_gutter-cell",style:{height:"1rem",top:"1rem"}},[(0,o.Uk)("2"),(0,o._)("span",{style:{display:"none"}})]),(0,o._)("div",{class:"ace_gutter-cell",style:{height:"1rem",top:"2rem"}},[(0,o.Uk)("3"),(0,o._)("span",{style:{display:"none"}})]),(0,o._)("div",{class:"ace_gutter-cell",style:{height:"1rem",top:"3rem"}},[(0,o.Uk)("4"),(0,o._)("span",{style:{display:"none"}})]),(0,o._)("div",{class:"ace_gutter-cell",style:{height:"1rem",top:"4rem"}},[(0,o.Uk)("5"),(0,o._)("span",{style:{display:"none"}})]),(0,o._)("div",{class:"ace_gutter-cell",style:{height:"1rem",top:"5rem"}},[(0,o.Uk)("6"),(0,o._)("span",{style:{display:"none"}})])])],-1))),f=p((()=>(0,o._)("div",{class:"ace_scroller",style:{"line-height":"1rem",left:"2rem"}},[(0,o._)("div",{class:"ace_content"},[(0,o._)("div",{class:"ace_layer ace_marker-layer"},[(0,o._)("div",{class:"ace_active-line",style:{height:"1rem",top:"1rem",left:"0px",right:"0px"}})]),(0,o._)("div",{class:"ace_layer ace_text-layer"},[(0,o._)("div",{class:"ace_line",style:{height:"1rem",top:"0rem"}},[(0,o._)("span",{class:"ace_keyword"},"Table"),(0,o.Uk)(),(0,o._)("span",{class:"ace_identifier"},"products"),(0,o.Uk)(),(0,o._)("span",{class:"ace_paren ace_lparen"},"{")]),(0,o._)("div",{class:"ace_line",style:{height:"1rem",top:"1rem"}},[(0,o.Uk)(" id "),(0,o._)("span",{class:"ace_support ace_function"},"int"),(0,o.Uk)(" ["),(0,o._)("span",{class:"ace_identifier"},"pk"),(0,o.Uk)("]")]),(0,o._)("div",{class:"ace_line",style:{height:"1rem",top:"2rem"}},[(0,o.Uk)(" name "),(0,o._)("span",{class:"ace_support ace_function"},"varchar")]),(0,o._)("div",{class:"ace_line",style:{height:"1rem",top:"3rem"}},[(0,o.Uk)(" merchant_id "),(0,o._)("span",{class:"ace_support ace_function"},"int"),(0,o.Uk)(" ["),(0,o._)("span",{class:"ace_identifier"},"not"),(0,o.Uk)(),(0,o._)("span",{class:"ace_identifier"},"null"),(0,o.Uk)("]")]),(0,o._)("div",{class:"ace_line",style:{height:"1rem",top:"4rem"}},[(0,o.Uk)(" price "),(0,o._)("span",{class:"ace_support ace_function"},"int")])])])],-1))),_=[g,f],b={class:"q-my-xs q-mx-sm text-caption"};function y(e,l,t,n,i,s){const r=(0,o.up)("q-card-section"),c=(0,o.up)("q-card");return(0,o.wg)(),(0,o.j4)(c,{class:(0,a.C_)([["ace-theme-preview-card","q-ma-sm",{"ace-theme-preview-card__active":t.active}],"flex column"]),style:(0,a.j5)(`width:${t.width};height:${t.height};`),bordered:""},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{class:"col col-grow"},{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,a.C_)(["ace_editor",`ace-${t.theme.name}`,`ace-${t.theme.name.replace("_","-")}`,{ace_dark:!!t.theme.isDark}])},_,2)])),_:1}),(0,o.Wm)(r,{class:"col-auto text-center"},{default:(0,o.w5)((()=>[(0,o._)("div",b,(0,a.zw)(t.theme.caption),1)])),_:1})])),_:1},8,["class","style"])}const w={name:"AceThemePreviewCard",props:{theme:{type:Object,required:!0},width:{type:[String,Number],default:()=>"10rem"},height:{type:[String,Number],default:()=>"8rem"},active:{type:Boolean,default:()=>!1}}};var v=t(1639),h=t(4458),k=t(3190),x=t(9984),q=t.n(x);const C=(0,v.Z)(w,[["render",y],["__scopeId","data-v-e5e3a5d6"]]),W=C;function U(e,l,t,a,n,i){const s=(0,o.up)("q-header"),r=(0,o.up)("q-page-container"),c=(0,o.up)("q-footer"),d=(0,o.up)("q-layout");return(0,o.wg)(),(0,o.j4)(d,{view:"hHh lpr lFr",container:"",style:"height:100%"},{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.WI)(e.$slots,"header")])),_:3}),(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.WI)(e.$slots,"default")])),_:3}),(0,o.Wm)(c,{class:"bg-dark"},{default:(0,o.w5)((()=>[(0,o.WI)(e.$slots,"footer")])),_:3})])),_:3})}q()(w,"components",{QCard:h.Z,QCardSection:k.Z});const S={name:"DialogLayout"};var Z=t(7605),I=t(6602),$=t(2133),Q=t(9860);const V=(0,v.Z)(S,[["render",U]]),R=V;q()(S,"components",{QLayout:Z.Z,QHeader:I.Z,QPageContainer:$.Z,QFooter:Q.Z});var F=t(1474),D=t(1306);const z={class:"q-gutter-y-lg"},E={class:"q-gutter-y-md"},H=(0,o._)("div",{class:"text-subtitle1"},"Grid",-1),T={class:"row q-col-gutter-x-sm"},L={class:"row q-col-gutter-x-sm"},j={class:"text-subtitle1"},B={class:"row q-col-gutter-md"},O={class:"row q-col-gutter-x-md"},M={__name:"GeneralTab",setup(e){const l=(0,F.g)(),t=(0,D.T)();function a(){t.checkSettings()&&t.saveRepoConfig()}return t.loadRepoConfig(),(e,n)=>{const s=(0,o.up)("q-input"),r=(0,o.up)("q-separator"),c=(0,o.up)("q-btn"),d=(0,o.up)("q-space");return(0,o.wg)(),(0,o.iD)("div",z,[(0,o._)("div",E,[H,(0,o._)("div",T,[(0,o.Wm)(s,{class:"col-md-4 col-lg-3",modelValue:(0,i.SU)(l).grid.size,"onUpdate:modelValue":n[0]||(n[0]=e=>(0,i.SU)(l).grid.size=e),modelModifiers:{number:!0},type:"number","stack-label":"",label:"Grid Size"},null,8,["modelValue"]),(0,o.Wm)(s,{class:"col-md-3 col-lg-2 col-xl-2",modelValue:(0,i.SU)(l).grid.divisions,"onUpdate:modelValue":n[1]||(n[1]=e=>(0,i.SU)(l).grid.divisions=e),modelModifiers:{number:!0},type:"number","stack-label":"",label:"Divisions"},null,8,["modelValue"])]),(0,o._)("div",L,[(0,o.Wm)(s,{class:"col-md-3 col-lg-2 col-xl-2",modelValue:(0,i.SU)(l).grid.snap,"onUpdate:modelValue":n[2]||(n[2]=e=>(0,i.SU)(l).grid.snap=e),modelModifiers:{number:!0},type:"number","stack-label":"",label:"Snap"},null,8,["modelValue"])])]),(0,o.Wm)(r),(0,o._)("div",null,[(0,o._)("div",j,[(0,o.Uk)("Repository (S3) "),(0,o.Wm)(c,{class:"q-ma-sm",color:"purple",label:"save",onClick:n[3]||(n[3]=()=>a())})]),(0,o._)("div",B,[(0,o.Wm)(s,{class:"col-md-4 col-lg-3",modelValue:(0,i.SU)(t).host,"onUpdate:modelValue":n[4]||(n[4]=e=>(0,i.SU)(t).host=e),modelModifiers:{trim:!0},type:"string","stack-label":"",label:"Host"},null,8,["modelValue"]),(0,o.Wm)(s,{class:"col-md-4 col-lg-3",modelValue:(0,i.SU)(t).bucket,"onUpdate:modelValue":n[5]||(n[5]=e=>(0,i.SU)(t).bucket=e),modelModifiers:{trim:!0},type:"string","stack-label":"",label:"Bucket"},null,8,["modelValue"]),(0,o.Wm)(s,{class:"col-md-4 col-lg-3",modelValue:(0,i.SU)(t).path,"onUpdate:modelValue":n[6]||(n[6]=e=>(0,i.SU)(t).path=e),modelModifiers:{trim:!0},type:"string","stack-label":"",label:"Comma-separated folders"},null,8,["modelValue"])]),(0,o._)("div",O,[(0,o.Wm)(s,{class:"col-md-4 col-lg-3",modelValue:(0,i.SU)(t).region,"onUpdate:modelValue":n[7]||(n[7]=e=>(0,i.SU)(t).region=e),modelModifiers:{trim:!0},type:"string","stack-label":"",label:"Region"},null,8,["modelValue"]),(0,o.Wm)(s,{class:"col-md-4 col-lg-3",modelValue:(0,i.SU)(t).access_key,"onUpdate:modelValue":n[8]||(n[8]=e=>(0,i.SU)(t).access_key=e),modelModifiers:{trim:!0},type:"string","stack-label":"",label:"Access_key"},null,8,["modelValue"]),(0,o.Wm)(s,{class:"col-md-4 col-lg-3",modelValue:(0,i.SU)(t).secret_key,"onUpdate:modelValue":n[9]||(n[9]=e=>(0,i.SU)(t).secret_key=e),modelModifiers:{trim:!0},type:"string","stack-label":"",label:"Secret_key"},null,8,["modelValue"])])]),(0,o.Wm)(d)])}}};var N=t(4152),A=t(926),K=t(8879),P=t(136);const Y=M,G=Y;q()(M,"components",{QInput:N.Z,QSeparator:A.Z,QBtn:K.Z,QSpace:P.Z});const J={class:"flex row justify-evenly"},X={__name:"ThemeTab",setup(e){const l=(0,s.E)(),t=u().require("ace/ext/themelist"),a=(0,i.iH)(t.themes);function n(e){l.preferences.theme=e.name}return(e,t)=>((0,o.wg)(),(0,o.iD)("div",J,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.value,(e=>((0,o.wg)(),(0,o.j4)((0,i.SU)(W),{key:e,theme:e,width:"30%",active:(0,i.SU)(l).preferences.theme===e.name,onClick:()=>n(e)},null,8,["theme","active","onClick"])))),128))]))}},ee=X,le=ee,te={name:"PreferencesDialog",components:{DialogLayout:R},props:{},emits:[...d.Z.emits],setup(){const{dialogRef:e,onDialogHide:l,onDialogOK:t,onDialogCancel:o}=(0,d.Z)(),a=(0,i.iH)([{name:"general",label:"General",component:G},{name:"thene",label:"Theme",component:le}]);return{tabs:a,dialogRef:e,onDialogHide:l,onOKClick(){t()},onCancelClick:o,tab:(0,i.iH)("general")}}};var oe=t(7743),ae=t(1663),ne=t(2230),ie=t(900),se=t(9800),re=t(4106);const ce=(0,v.Z)(te,[["render",c],["__scopeId","data-v-0b182c32"]]),de=ce;q()(te,"components",{QDialog:oe.Z,QCard:h.Z,QToolbar:ae.Z,QTabs:ne.Z,QTab:ie.Z,QTabPanels:se.Z,QTabPanel:re.Z,QSpace:P.Z,QBtn:K.Z});var me=t(3216),ue=t(9403),pe=t.n(ue);(0,r.Z)();const{exporter:ge}=t(8423),fe=(0,me.B)(),_e=pe().createInstance({name:"dbdiagram-oss",storeName:"files"}),be=(0,F.g)();function ye(e){_e.getItem(fe.getCurrentFile).then((l=>{ke(new Blob([JSON.stringify(l)],{type:"application/json"}),e)}))}function we(e,l){_e.getItem(fe.getCurrentFile).then((t=>{const o=ge.export(t.source.text,l);ke(new Blob([o],{type:"text/plain"}),"dbml"==l?e:l+"_"+e)}))}function ve(e){let l=xe();ke(new Blob([l.svg.outerHTML.trim()]),e)}function he(e,l){let t=xe();var o=new Image;o.height=t.size.height,o.width=t.size.width,o.src="data:image/svg+xml;base64,"+window.btoa((new XMLSerializer).serializeToString(t.svg));let a=l.value/96;o.onload=function(){console.log("load image");var l=document.createElement("canvas");l.width=o.width*a,l.height=o.height*a;var t=l.getContext("2d");t.drawImage(o,0,0),t.setTransform(a,0,0,a,0,0);var n=document.createElement("a");n.download=e,n.href=l.toDataURL("image/png",1),document.body.appendChild(n),n.click()}}function ke(e,l){const t=document.createElement("a"),o=e,a=window.URL.createObjectURL(o);t.setAttribute("href",a),t.setAttribute("download",l),t.click(),URL.revokeObjectURL(a),setTimeout((()=>{document.removeChild(t)}),1e3)}function xe(){let e=document.createElement("div"),l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttribute("class","db-chart db-chart__bg"),l.setAttribute("version","1.1"),l.setAttribute("xmlns","http://www.w3.org/2000/svg"),l.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");let t=qe({l:0,r:0,t:0,b:0},be.getTables);t=qe(t,be.getTableGroups);let o=be.getRefs;console.log(o);for(let m in o)o[m].vertices.length>0&&(t=qe(t,o[m].vertices,!0));let a={width:Math.abs(t.l)+t.r+40,height:Math.abs(t.t)+t.b+40};l.setAttribute("viewBox",`${t.l-20} ${t.t-20} ${a.width}  ${a.height}`);var n=document.getElementById("tablegroups-layer");l.appendChild(n.cloneNode(!0));var i=document.getElementById("tables-layer");l.appendChild(i.cloneNode(!0));let s=l.getElementById("tables-layer").getElementsByClassName("db-table-header__color-icon");while(s.length>0)s[0].parentNode.removeChild(s[0]);let r=l.getElementById("tables-layer").getElementsByClassName("db-field__note-icon");while(r.length>0)r[0].parentNode.removeChild(r[0]);var c=document.getElementById("refs-layer");l.appendChild(c.cloneNode(!0));let d=l.getElementById("refs-layer").children;for(let m of d)m.removeChild(m.getElementsByClassName("db-ref__control-points")[0]);return e.appendChild(l),Ce(e,["fill","font-family","font-size","stroke","stroke-width","stroke-linejoin","stroke-opacity","stroke-linecap","transform","text-anchor","font-weight","vertical-align"],["background-color"]),{svg:l,size:a}}function qe(e,l,t=!1){for(let o in l)l[o].x<e.l&&(e.l=l[o].x),l[o].y<e.t&&(e.t=l[o].y),t||(l[o].x+l[o].width>e.r&&(e.r=l[o].x+l[o].width),l[o].y+l[o].height>e.b&&(e.b=l[o].y+l[o].height));return e}function Ce(e,l,t){let o=window.getComputedStyle(document.body),a=document.styleSheets;for(let n=0;n<a.length;n++){let i=a[n].cssRules;for(let a=0;a<i.length;a++){let n=i[a];if("undefined"!=typeof n.style){let a=e.querySelectorAll(n.selectorText);if(a.length>0)for(let e of a)if(n.style.length>0)for(let a=0;a<n.style.length;a++){if(l.some((e=>e===n.style[a]))){let l=Se(n.style[n.style[a]],o);null==l&&(l=n.style[n.style[a]]),"transform"==n.style[a]&&(l=We(l)),e.setAttribute(n.style[a],l)}if(t.some((e=>e===n.style[a]))){let l=Se(n.style[n.style[a]],o);null==l&&(l=n.style[n.style[a]]);let t=e.getAttribute("style");null!=t?e.setAttribute("style",`${t} ${n.style[a]}:${l};`):e.setAttribute("style",`${n.style[a]}:${l};`)}}}}}}function We(e){const l=RegExp(/translateX\(([+-]?\d+\.?\d*)(.*?)\) translateY\(([+-]?\d+\.?\d*)(.*?)\)/,"iu");if(l.test(e)){let t=l.exec(e);return`translate(${Ue(t[1],t[2])} ${Ue(t[3],t[4])})`}return e}function Ue(e,l){return"px"==l?e:"em"==l?16*Number(e):e+l}function Se(e,l){const t=RegExp(/var\((--.*?)\)/,"iu");if(t.test(e)){let o=t.exec(e);return l.getPropertyValue(o[1])}return null}t(4477);const Ze={style:{margin:"10px"}},Ie={class:"q-gutter-y-lg"},$e={__name:"VDbExportDialog",props:{id:{type:String,required:!0},file_name:{type:String,required:!0}},emits:[...d.Z.emits],setup(e){const l=e,t=(0,r.Z)(),n=((0,F.g)(),(0,i.iH)(l.file_name)),s=(0,i.iH)(300),{dialogRef:c,onDialogHide:m,onDialogOK:u,onDialogCancel:p}=(0,d.Z)();function g(){t.notify({caption:"Export",message:"Saving file...",multiLine:!0,timeout:2e3,color:"indigo-7",spinner:!0,position:"center"}),f(),u()}function f(){(0,me.B)(),pe().createInstance({name:"dbdiagram-oss",storeName:"files"});"json"==l.id&&ye(l.file_name),"svg"==l.id&&ve(l.file_name),"pg"==l.id&&we(l.file_name,"postgres"),"mssql"==l.id&&we(l.file_name,"mssql"),"mysql"==l.id&&we(l.file_name,"mysql"),"dbml"==l.id&&we(l.file_name,"dbml"),"png"==l.id&&he(l.file_name,s),t.notify({caption:"Export",message:`File ${n.value} successfully exported`,color:"green",icon:"task",position:"bottom-right"})}return(e,t)=>{const r=(0,o.up)("q-icon"),d=(0,o.up)("q-bar"),u=(0,o.up)("q-input"),f=(0,o.up)("q-card-section"),_=(0,o.up)("q-btn"),b=(0,o.up)("q-card-actions"),y=(0,o.up)("q-card"),w=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(w,{ref_key:"dialogRef",ref:c,onHide:(0,i.SU)(m)},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{class:"q-dialog-plugin ace-preferences-dialog"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o.Wm)(r,{name:"download"}),(0,o._)("h6",Ze,"Export "+(0,a.zw)(l.id),1)])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o._)("div",Ie,[(0,o.Wm)(u,{class:"col-md-4 col-lg-3",modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),type:"string","stack-label":"",label:"File name"},null,8,["modelValue"]),"png"==l.id?((0,o.wg)(),(0,o.j4)(u,{key:0,class:"col-md-4 col-lg-3",modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=e=>s.value=e),type:"number","stack-label":"",label:"PNG Resolution"},null,8,["modelValue"])):(0,o.kq)("",!0)])])),_:1}),(0,o.Wm)(b,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{flat:"",color:"primary",label:"Cancel",onClick:(0,i.SU)(p)},null,8,["onClick"]),(0,o.Wm)(_,{flat:"",color:"primary",label:"OK",onClick:g})])),_:1})])),_:1})])),_:1},8,["onHide"])}}};var Qe=t(4526),Ve=t(2857),Re=t(1821);const Fe=$e,De=Fe;q()($e,"components",{QDialog:oe.Z,QCard:h.Z,QBar:Qe.Z,QIcon:Ve.Z,QCardSection:k.Z,QInput:N.Z,QCardActions:Re.Z,QBtn:K.Z});const ze={style:{margin:"10px"}},Ee={class:"q-gutter-y-lg"},He={__name:"VDbImportDialog",props:{id:{type:String,required:!0},ext:{type:String,required:!0}},emits:[...d.Z.emits],setup(e){const l=e,{importer:n}=t(8423),{dialogRef:c,onDialogHide:m,onDialogOK:u,onDialogCancel:p}=(0,d.Z)(),g=(0,me.B)(),f=pe().createInstance({name:"dbdiagram-oss",storeName:"files"}),_=(0,r.Z)(),b=(0,i.iH)(null),y=(0,i.iH)(),w=()=>`.${l.ext}`,v=e=>{_.notify({type:"negative",message:`${e.length} file(s) did not pass validation constraints, wrong type`})};function h(e){return e=e.split("\\").pop(),{name:e.substring(0,e.lastIndexOf(".")),extension:e.split(".").pop()}}function k(e,t){x(e,(e=>{console.log(y.value);let o=null;if(null!=e.error)_.notify({caption:"Import",message:`${b.value.name} ${e.error}`,multiLine:!0,color:"red",icon:"warning",position:"bottom-right"});else{if("R"==t)if("pg"==l.id)try{const l=n.import(e.data,"postgres");f.getItem(y.value).then(((e,t)=>{null==e&&(t.source.text=l,f.setItem(y.value,t).then((()=>{g.loadFile(y.value)}))),_.notify({caption:"Import",message:`File ${y.value} replaced`,multiLine:!0,color:"green",icon:"upload",position:"bottom-right"})}))}catch(a){o=a,_.notify({caption:"Import > "+a.name,html:!0,message:`<div> <span>Import file [${y.value}] error occured, founded: ${a.found} </span> \n                                            <div>\n                                            <div>Start line: ${a.location.start.line}, column: ${a.location.start.column} </div>\n                                            <div>End line: ${a.location.end.line}, column: ${a.location.end.column} </div>\n                                            </div>\n                                            <p>${a.message}</p> Open console for more information </div>`,multiLine:!0,color:"red",icon:"warning",progress:!0,position:"bottom-right",timeout:1e4}),console.error("IMPORT ERROR",a)}else f.setItem(y.value,e.data).then((()=>{g.loadFile(y.value)})),_.notify({caption:"Import",message:`File ${y.value} replaced`,multiLine:!0,color:"green",icon:"upload",position:"bottom-right"});if("SC"==t){let t=0,i=y.value;while(g.getFiles.includes(i))i=i+"_copy"+t,t++;if("pg"==l.id)try{const l=(0,s.E)(),t=n.import(e.data,"postgres");g.newImportFile(i),l.updateSourceText(t),_.notify({caption:"Import",message:`File copy ${y.value} saved`,multiLine:!0,color:"green",icon:"upload",position:"bottom-right"})}catch(a){o=a,_.notify({caption:"Import > "+a.name,html:!0,message:`<div> <span>Import file [${y.value}] error occured, founded: ${a.found} </span> \n                                            <div>\n                                            <div>Start line: ${a.location.start.line}, column: ${a.location.start.column} </div>\n                                            <div>End line: ${a.location.end.line}, column: ${a.location.end.column} </div>\n                                            </div>\n                                            <p>${a.message}</p> Open console for more information </div>`,multiLine:!0,color:"red",icon:"warning",progress:!0,position:"bottom-right",timeout:1e4}),console.error("IMPORT ERROR",a)}else f.setItem(i,e.data).then((()=>{g.loadFile(i)})),_.notify({caption:"Import",message:`File copy ${y.value} saved`,multiLine:!0,color:"green",icon:"upload",position:"bottom-right"})}if("S"==t)if("pg"==l.id)try{const l=(0,s.E)(),t=n.import(e.data,"postgres");g.newImportFile(y.value),l.updateSourceText(t)}catch(a){o=a,_.notify({caption:"Import > "+a.name,html:!0,message:`<div> <span>Import file [${y.value}] error occured, founded: ${a.found} </span> \n                                            <div>\n                                            <div>Start line: ${a.location.start.line}, column: ${a.location.start.column} </div>\n                                            <div>End line: ${a.location.end.line}, column: ${a.location.end.column} </div>\n                                            </div>\n                                            <p>${a.message}</p> Open console for more information </div>`,multiLine:!0,color:"red",icon:"warning",progress:!0,position:"bottom-right",timeout:1e4}),console.error("IMPORT ERROR",a)}else f.setItem(y.value,e.data).then((()=>{g.loadFile(y.value)}));null==o&&_.notify({caption:"Import",message:`File ${y.value} imported`,multiLine:!0,color:"green",icon:"upload",position:"bottom-right"}),u()}}))}function x(e,t){function o(t){let o=new FileReader;o.addEventListener("load",(e=>{let a=o.result,n=null,i=a;if("json"==l.id){let e=JSON.parse(a);void 0!=e.source&&void 0!=e.preferences&&void 0!=e.chart?i=e:n="The file structure is incompatible with the application"}let s={data:i,error:n};t(s)})),o.readAsText(e)}o(t)}function q(){if(null!=b.value){h(b.value.name);g.getFiles.includes(y.value)?_.notify({caption:"Import",message:`File ${y.value} already exists`,multiLine:!0,color:"indigo-7",icon:"upload",position:"center",actions:[{label:"Replace",color:"red",handler:()=>{k(b.value,"R")}},{label:"Save copy",color:"green",handler:()=>{k(b.value,"SC")}},{label:"Dismiss",color:"grey",handler:()=>{_.notify({caption:"Import",message:`${y.value} not saved`,multiLine:!0,color:"red",icon:"warning",position:"bottom-right"})}}]}):(k(b.value,"S"),u())}else _.notify({caption:"Import",message:"File not selected",multiLine:!0,color:"red",icon:"warning",position:"bottom-right"})}function C(e){console.log(e.target),console.log(e.target.value);let l=h(e.target.value);y.value=l.name}function W(){b.value=null}return(e,t)=>{const n=(0,o.up)("q-icon"),s=(0,o.up)("q-bar"),r=(0,o.up)("q-file"),d=(0,o.up)("q-input"),u=(0,o.up)("q-card-section"),g=(0,o.up)("q-btn"),f=(0,o.up)("q-card-actions"),_=(0,o.up)("q-form"),h=(0,o.up)("q-card"),k=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(k,{ref_key:"dialogRef",ref:c,onHide:(0,i.SU)(m)},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{class:"q-dialog-plugin ace-preferences-dialog"},{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(n,{name:"download"}),(0,o._)("h6",ze,"Import "+(0,a.zw)(l.id),1)])),_:1}),(0,o.Wm)(_,{onSubmit:q,onReset:W},{default:(0,o.w5)((()=>[(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o._)("div",Ee,[(0,o.Wm)(r,{class:"col-md-4 col-lg-3",modelValue:b.value,"onUpdate:modelValue":t[0]||(t[0]=e=>b.value=e),label:"Browse file",accept:w(),onInput:C,onRejected:v},{prepend:(0,o.w5)((()=>[(0,o.Wm)(n,{name:"attach_file"})])),_:1},8,["modelValue","accept"]),(0,o.Wm)(d,{class:"col-md-4 col-lg-3",modelValue:y.value,"onUpdate:modelValue":t[1]||(t[1]=e=>y.value=e),type:"string","stack-label":"",label:"Change file name"},null,8,["modelValue"])])])),_:1}),(0,o.Wm)(f,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{flat:"",color:"primary",label:"Cancel",onClick:(0,i.SU)(p)},null,8,["onClick"]),(0,o.Wm)(g,{flat:"",color:"primary",type:"submit",label:"OK"})])),_:1})])),_:1})])),_:1})])),_:1},8,["onHide"])}}};var Te=t(8326),Le=t(1527);const je=He,Be=je;q()(He,"components",{QDialog:oe.Z,QCard:h.Z,QBar:Qe.Z,QIcon:Ve.Z,QForm:Te.Z,QCardSection:k.Z,QFile:Le.Z,QInput:N.Z,QCardActions:Re.Z,QBtn:K.Z});const Oe={class:"q-py-sm flex"},Me={class:"block q-mx-sm"},Ne={__name:"Toolbar",setup(e){const l=(0,s.E)(),t=(0,me.B)(),c=(0,r.Z)(),d=(0,D.T)();(0,o.bv)((()=>{setTimeout((()=>{console.log("load from repository"),d.loadRepoConfig(),setTimeout((()=>{d.getRepoFiles()}),500)}),300)}));const m=(0,i.iH)([{id:"json",label:"Json",ext:"json"},{id:"svg",label:"SVG",ext:"svg"},{id:"png",label:"PNG",ext:"png"},{id:"dbml",label:"DBML",ext:"dbml"},{id:"pg",label:"Postgres",ext:"sql"},{id:"mssql",label:"MSSQL",ext:"sql"},{id:"mysql",label:"MySQL",ext:"sql"}]),u=(0,i.iH)([{id:"json",label:"Json",ext:"json"},{id:"pg",label:"Postgres",ext:"sql"}]),p=(0,o.Fl)({get:()=>l.getDark,set:e=>l.updateDark(e)}),g=(0,o.Fl)({get:()=>t.getCurrentFile,set:e=>t.loadFile(e)}),f=(0,o.Fl)((()=>t.getFiles)),_=(0,o.Fl)((()=>d.getFiles)),b=e=>t.deleteFile(e),y=()=>t.newFile(),w=()=>t.saveFile(),v=e=>d.sendInRepo(e),h=e=>d.loadFromRepo(e),k=e=>t.loadFile(e),x=e=>{c.dialog({title:"Confirm Deletion",message:`Are you sure you want to delete the file '${e}'?`,cancel:!0,persistent:!0}).onOk((()=>{console.log("delete confirmed",e),b(e)}))},q=e=>{void 0===e&&(e=t.currentFile),c.dialog({title:"Rename file",message:"Enter a new file name below.",prompt:{model:e,type:"text"},cancel:!0,persistent:!1}).onOk((e=>{console.log("rename to ",e),t.renameFile(e)}))},C=()=>{c.dialog({component:de})},W=(e,l)=>{var o=t.getCurrentFile.split("/"),a=o[o.length-1].split(".")[0]+"."+l;console.log(o,e,l),c.dialog({component:De,componentProps:{id:e,file_name:a}})},U=(e,l)=>{console.log(e),c.dialog({component:Be,componentProps:{id:e,ext:l}})};return(e,l)=>{const t=(0,o.up)("q-item-label"),s=(0,o.up)("q-item-section"),r=(0,o.up)("q-btn"),c=(0,o.up)("q-item"),b=(0,o.up)("q-separator"),S=(0,o.up)("q-list"),Z=(0,o.up)("q-btn-dropdown"),I=(0,o.up)("q-icon"),$=(0,o.up)("q-space"),Q=(0,o.up)("q-toggle"),V=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",Oe,[(0,o.Wm)(Z,{split:"",dense:"","no-caps":"",class:"dbml-fileselector bg-secondary",align:"left",onClick:l[0]||(l[0]=()=>q()),anchor:"bottom right",self:"top right"},{label:(0,o.w5)((()=>[(0,o._)("span",Me,(0,a.zw)(g.value),1)])),default:(0,o.w5)((()=>[(0,o.Wm)(S,{dense:""},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(f.value,(e=>((0,o.wg)(),(0,o.j4)(c,{key:e,clickable:"",onClick:()=>k(e)},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{class:"q-py-xs"},{default:(0,o.w5)((()=>[(0,o.Wm)(t,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e),1)])),_:2},1024)])),_:2},1024),(0,o.Wm)(s,{thumbnail:""},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{icon:"delete",size:"sm",flat:"",dense:"",round:"",onClick:(0,n.iM)((()=>x(e)),["stop"])},null,8,["onClick"])])),_:2},1024)])),_:2},1032,["onClick"])))),128)),(0,o.Wm)(b),(0,o.Wm)(c,{clickable:"",dense:"",onClick:y},{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(t,{class:"text-italic"},{default:(0,o.w5)((()=>[(0,o.Uk)("Create New File")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.Wm)(r,{padding:"sm",size:"md",class:"bg-secondary q-mx-xs",onClick:w},{default:(0,o.w5)((()=>[(0,o.Wm)(I,{size:"xs",name:"save"})])),_:1}),(0,o.Wm)(Z,{padding:"xs sm",size:"md",color:"secondary",class:"q-mx-xs",onShow:(0,i.SU)(d).getRepoFiles},{label:(0,o.w5)((()=>[(0,o.Wm)(I,{class:"q-mr-sm",size:"sm",name:"cloud_upload"}),(0,o.Uk)(" to repo ")])),default:(0,o.w5)((()=>[(0,o.Wm)(S,{dense:""},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,i.SU)(d).getFolders,(e=>(0,o.wy)(((0,o.wg)(),(0,o.j4)(c,{key:e,clickable:"",onClick:()=>v(e)},{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(t,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])),[[V]]))),128))])),_:1})])),_:1},8,["onShow"]),(0,o.Wm)(Z,{padding:"xs sm",size:"md",color:"secondary",class:"q-mx-xs",onShow:(0,i.SU)(d).getRepoFiles},{label:(0,o.w5)((()=>[(0,o.Wm)(I,{class:"q-mr-sm",size:"sm",name:"cloud_download"}),(0,o.Uk)(" from repo ")])),default:(0,o.w5)((()=>[(0,o.Wm)(S,{dense:""},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(_.value,(e=>(0,o.wy)(((0,o.wg)(),(0,o.j4)(c,{key:e,clickable:"",onClick:()=>h(e)},{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(t,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])),[[V]]))),128))])),_:1})])),_:1},8,["onShow"]),(0,o.Wm)(Z,{padding:"xs sm",size:"md",color:"secondary",class:"q-mx-xs"},{label:(0,o.w5)((()=>[(0,o.Wm)(I,{class:"q-mr-sm",size:"xs",name:"file_download"}),(0,o.Uk)(" Export ")])),default:(0,o.w5)((()=>[(0,o.Wm)(S,{dense:""},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(m.value,(e=>((0,o.wg)(),(0,o.j4)(c,{key:e.id,clickable:"",onClick:l=>W(e.id,e.ext),dense:""},{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(t,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1}),(0,o.Wm)(Z,{padding:"xs sm",size:"md",color:"secondary",class:"q-mx-xs"},{label:(0,o.w5)((()=>[(0,o.Wm)(I,{class:"q-mr-sm",size:"xs",name:"file_upload"}),(0,o.Uk)(" Import ")])),default:(0,o.w5)((()=>[(0,o.Wm)(S,{dense:""},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(u.value,(e=>((0,o.wg)(),(0,o.j4)(c,{key:e.id,clickable:"",onClick:l=>U(e.id,e.ext),dense:""},{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(t,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})]),(0,o.Wm)($),(0,o.Wm)(r,{padding:"sm",size:"md",class:"bg-secondary",onClickCapture:l[1]||(l[1]=e=>p.value=!p.value)},{default:(0,o.w5)((()=>[(0,o.Wm)(I,{class:"q-mr-xs",size:"xs",name:"dark_mode"}),(0,o.Wm)(Q,{ref:"dark_toggle",class:"q-ml-sm no-pointer-events",size:"sm",dense:"",color:"primary","model-value":p.value,dark:p.value},null,8,["model-value","dark"])])),_:1}),(0,o.Wm)(r,{padding:"sm",size:"md",class:"bg-secondary q-mx-xs",style:{"touch-action":"auto"},onClick:C},{default:(0,o.w5)((()=>[(0,o.Wm)(I,{size:"xs",name:"settings"})])),_:1})],64)}}};var Ae=t(2889),Ke=t(3246),Pe=t(490),Ye=t(6749),Ge=t(3115),Je=t(3175),Xe=t(2146);const el=(0,v.Z)(Ne,[["__scopeId","data-v-89292064"]]),ll=el;q()(Ne,"components",{QBtnDropdown:Ae.Z,QList:Ke.Z,QItem:Pe.Z,QItemSection:Ye.Z,QItemLabel:Ge.Z,QBtn:K.Z,QSeparator:A.Z,QIcon:Ve.Z,QSpace:P.Z,QToggle:Je.Z}),q()(Ne,"directives",{ClosePopup:Xe.Z})}}]);